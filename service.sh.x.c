#if 0
	shc Version 3.8.7, Generic Script Compiler
	Copyright (c) 1994-2009 Francisco Rosales <frosal@fi.upm.es>

	./shc -v -r -T -f service.sh 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[1]))
	"\141\314\204\265\226\111\166\372\226\126\245\360\056\025\364\122"
	"\253\007\105\202"
#define      text_z	3628
#define      text	((&data[91]))
	"\137\373\010\263\021\131\254\145\102\003\160\372\162\327\062\207"
	"\072\326\171\135\230\003\016\210\000\151\242\141\070\267\214\230"
	"\262\225\113\303\356\370\051\060\374\231\053\157\161\135\366\254"
	"\064\157\012\315\163\030\125\163\202\370\325\273\257\141\124\142"
	"\366\240\045\345\230\117\025\360\176\021\013\172\326\350\265\223"
	"\347\336\274\224\053\240\352\323\105\373\050\140\152\342\177\224"
	"\153\126\113\352\116\314\244\055\211\277\075\106\110\117\031\345"
	"\277\272\114\011\041\034\244\012\352\203\125\111\331\020\276\244"
	"\126\305\074\200\210\065\130\054\364\242\361\323\161\305\074\256"
	"\027\053\226\331\131\345\005\132\164\105\262\150\157\117\012\063"
	"\303\112\000\353\227\177\352\251\247\153\267\304\342\311\374\155"
	"\273\155\243\014\066\154\165\075\260\066\255\066\344\253\204\046"
	"\376\274\022\177\211\130\323\062\111\123\144\272\115\077\014\153"
	"\070\223\212\264\203\312\130\373\007\141\150\072\050\350\226\177"
	"\007\226\331\200\162\325\101\325\147\344\335\130\162\237\203\247"
	"\063\236\012\342\361\021\070\270\071\357\026\362\060\022\170\060"
	"\310\076\051\006\355\336\254\272\037\063\254\043\307\271\200\112"
	"\306\001\201\157\336\256\026\042\277\272\220\201\344\214\373\341"
	"\071\362\332\110\140\054\143\361\162\153\157\230\222\320\036\276"
	"\357\311\302\164\361\144\267\166\175\222\344\310\150\257\331\077"
	"\011\006\333\077\174\346\371\367\333\232\324\376\112\037\333\173"
	"\257\373\255\200\324\061\361\072\163\332\227\347\076\122\210\126"
	"\323\003\206\222\252\163\002\104\262\345\070\166\353\030\326\063"
	"\305\260\035\106\245\366\163\074\331\274\066\021\151\061\206\343"
	"\000\106\323\033\265\277\227\345\036\060\240\231\123\077\306\237"
	"\211\001\243\214\027\233\001\100\172\317\054\341\004\307\352\106"
	"\040\126\037\276\374\000\115\211\303\161\135\322\044\126\214\335"
	"\040\351\046\253\351\016\322\166\353\161\356\140\303\205\310\120"
	"\206\317\065\235\064\165\056\032\337\273\232\176\315\016\225\202"
	"\365\231\276\340\342\062\034\354\212\201\045\043\103\141\130\320"
	"\306\313\152\106\306\076\150\154\125\214\366\046\164\175\002\177"
	"\212\213\016\167\370\156\206\165\231\375\313\003\137\135\253\077"
	"\267\056\250\166\301\110\072\364\102\002\223\221\033\242\000\260"
	"\041\261\122\160\377\371\355\121\000\026\312\307\177\067\104\274"
	"\112\321\316\313\016\007\334\224\212\065\001\232\325\042\233\214"
	"\032\111\201\130\131\264\343\310\022\072\025\363\152\071\256\132"
	"\265\206\136\350\241\365\061\074\200\050\154\203\254\320\011\344"
	"\046\307\065\131\153\124\352\046\006\135\033\376\202\316\333\070"
	"\310\027\212\133\026\300\273\326\053\042\121\340\356\306\212\112"
	"\032\304\025\147\041\073\036\250\327\372\273\104\051\061\114\160"
	"\236\023\070\052\345\152\311\232\064\001\346\031\372\047\215\172"
	"\037\261\104\041\352\015\141\067\364\060\130\133\303\057\076\310"
	"\021\355\332\037\212\054\213\371\102\125\200\102\266\307\024\355"
	"\300\213\212\013\064\342\216\024\061\164\175\270\110\351\167\154"
	"\134\152\050\172\140\023\263\327\177\137\203\263\267\365\037\371"
	"\224\170\306\022\164\145\167\164\334\335\272\074\233\304\353\262"
	"\165\015\236\237\102\266\211\213\052\111\373\356\245\331\313\236"
	"\031\151\247\320\111\257\221\224\135\023\064\052\267\321\266\332"
	"\317\321\037\053\346\045\172\335\352\241\211\104\165\125\366\374"
	"\243\211\261\002\140\101\140\262\031\106\153\236\242\163\024\340"
	"\273\126\072\003\324\343\336\207\226\347\343\272\302\014\370\040"
	"\112\362\336\210\125\053\242\266\350\011\326\215\003\117\252\216"
	"\313\052\053\166\307\365\176\364\061\146\305\254\376\127\061\026"
	"\334\164\023\010\155\217\027\200\032\124\311\070\201\011\253\311"
	"\075\031\217\350\204\041\065\246\251\013\326\130\053\002\031\237"
	"\223\146\171\030\276\140\340\215\066\102\002\000\230\073\044\127"
	"\044\064\071\042\272\367\060\062\304\125\152\263\106\361\005\343"
	"\232\253\353\170\061\310\343\202\306\242\063\076\111\100\321\227"
	"\311\154\143\210\235\153\220\370\207\220\030\021\151\105\322\036"
	"\264\033\161\337\112\030\156\207\022\245\350\324\067\157\275\204"
	"\055\040\163\367\153\075\144\240\024\347\101\016\263\306\066\122"
	"\301\374\123\030\025\141\043\321\230\161\132\336\214\266\136\277"
	"\074\032\143\375\117\323\200\156\357\246\205\022\343\232\371\021"
	"\245\327\300\052\236\017\161\143\104\220\307\173\136\127\375\235"
	"\023\215\356\021\170\001\005\000\367\075\071\153\333\233\174\007"
	"\036\250\053\257\363\144\365\202\155\255\136\206\213\021\242\317"
	"\240\214\151\047\120\072\341\200\152\014\341\133\347\267\363\313"
	"\251\370\074\267\006\102\261\253\102\130\374\230\042\071\000\367"
	"\040\374\142\145\234\205\203\272\350\251\152\161\352\324\270\333"
	"\324\136\244\001\120\355\165\212\334\307\371\047\122\156\045\205"
	"\262\163\257\130\356\004\133\206\364\125\253\217\322\243\031\067"
	"\015\044\172\364\361\257\251\144\114\057\262\007\367\253\257\245"
	"\167\024\073\135\360\103\037\126\104\043\261\024\213\151\360\241"
	"\344\152\340\222\342\055\047\075\167\240\312\241\351\317\236\063"
	"\251\033\111\274\270\032\244\070\112\063\057\344\316\151\053\264"
	"\140\000\330\350\100\024\310\354\143\307\012\215\151\304\230\104"
	"\075\231\257\024\301\230\256\056\243\363\335\145\373\075\312\051"
	"\025\367\120\172\322\003\035\162\077\133\236\365\074\116\363\203"
	"\103\376\210\105\327\173\361\010\027\010\151\204\354\112\175\256"
	"\156\310\353\240\251\264\026\275\274\361\153\321\131\213\101\372"
	"\151\236\160\277\265\223\004\123\065\214\114\020\112\272\020\102"
	"\062\212\205\356\331\034\263\107\113\202\124\212\317\132\152\360"
	"\260\153\006\063\261\057\320\123\317\352\040\202\361\026\072\052"
	"\350\251\050\105\252\166\373\334\072\063\130\276\250\205\225\255"
	"\220\061\365\044\214\265\133\233\352\216\355\160\370\326\307\343"
	"\252\320\210\175\042\063\275\376\065\226\033\310\045\177\011\222"
	"\214\111\307\252\373\350\135\377\123\271\246\277\220\121\204\272"
	"\223\116\375\001\234\004\253\225\246\312\205\370\073\144\023\153"
	"\256\010\275\023\160\352\133\345\266\262\146\202\004\221\103\303"
	"\146\001\037\343\174\116\125\116\203\027\327\247\031\032\276\344"
	"\224\044\347\362\320\111\175\271\370\037\162\003\364\203\143\331"
	"\233\076\343\222\014\252\351\266\021\312\310\167\211\311\205\331"
	"\147\222\073\212\350\175\110\364\261\116\147\025\154\341\017\250"
	"\335\332\362\067\260\023\237\141\157\024\222\055\273\300\150\156"
	"\002\020\225\067\075\225\032\306\311\143\057\006\003\112\146\302"
	"\215\324\213\221\074\152\241\053\143\116\154\010\345\200\133\114"
	"\122\201\307\203\161\171\275\201\263\021\263\325\263\306\273\366"
	"\321\340\342\335\172\123\066\032\133\330\302\307\373\072\273\036"
	"\207\037\071\211\047\324\316\265\244\316\054\047\111\033\157\130"
	"\367\326\137\100\346\112\355\115\202\334\361\024\035\101\350\063"
	"\016\265\262\145\275\226\203\030\242\154\317\150\302\067\174\177"
	"\240\016\344\310\345\257\040\030\306\301\061\360\160\177\031\145"
	"\341\351\245\116\240\146\034\271\202\207\005\342\004\203\126\337"
	"\227\115\376\171\234\371\101\131\250\367\117\075\224\321\227\106"
	"\306\205\076\000\245\074\001\363\013\246\204\077\244\322\067\042"
	"\244\276\357\373\153\100\215\364\335\046\220\006\164\133\240\303"
	"\335\106\032\164\207\235\327\142\176\120\133\125\337\352\253\200"
	"\215\322\252\045\267\351\215\107\142\255\115\117\313\231\057\023"
	"\017\046\162\123\346\041\352\237\164\257\055\007\006\170\036\264"
	"\167\306\163\365\007\367\126\173\206\163\103\313\355\035\021\125"
	"\133\300\365\061\101\236\243\144\376\107\352\152\304\131\016\265"
	"\061\104\156\050\266\127\376\026\161\277\063\276\047\201\036\136"
	"\350\266\253\126\326\005\005\376\250\314\357\160\034\213\303\053"
	"\242\365\253\164\004\344\146\215\234\046\000\253\037\147\107\246"
	"\367\326\342\250\354\301\227\277\240\132\243\213\334\055\354\261"
	"\015\122\221\277\327\000\373\036\106\257\325\020\167\263\073\121"
	"\163\112\314\310\231\045\215\127\276\272\104\303\105\047\331\277"
	"\374\322\013\075\361\221\000\317\023\054\236\264\170\213\361\261"
	"\334\160\312\267\174\364\102\144\111\361\370\205\220\124\370\005"
	"\302\377\366\256\155\215\312\242\240\016\211\062\200\030\162\333"
	"\167\367\214\205\006\224\365\200\175\221\366\150\177\374\257\263"
	"\075\134\137\357\232\127\321\262\313\050\216\355\147\330\114\041"
	"\353\165\331\205\132\315\257\022\271\045\153\124\323\131\301\103"
	"\201\154\334\000\167\003\306\243\142\135\173\345\004\306\134\034"
	"\155\071\332\060\202\153\061\052\151\114\265\017\223\205\261\241"
	"\121\331\334\047\324\002\036\211\107\316\325\011\024\105\277\146"
	"\370\241\023\340\151\342\262\027\333\104\323\305\257\232\253\131"
	"\350\032\302\035\071\177\231\146\040\271\202\076\215\204\305\144"
	"\232\332\001\053\040\322\042\226\124\245\022\217\233\116\324\062"
	"\205\235\000\106\227\136\163\011\102\171\072\074\145\232\223\356"
	"\363\104\277\225\213\004\176\343\357\261\154\255\326\147\176\255"
	"\172\167\115\105\231\260\347\033\032\370\055\135\065\373\211\052"
	"\155\136\055\007\346\233\356\102\024\357\162\341\046\163\340\247"
	"\027\001\016\232\120\141\042\176\246\377\041\114\352\114\257\044"
	"\146\243\155\146\346\203\002\344\144\071\212\011\027\267\040\146"
	"\307\153\301\262\305\074\100\355\112\301\264\141\223\167\117\175"
	"\066\170\236\153\040\104\264\317\370\007\373\057\202\065\042\076"
	"\335\076\323\050\145\223\106\374\324\062\124\115\253\200\214\127"
	"\073\217\245\163\142\223\375\151\125\042\352\124\214\351\347\015"
	"\175\254\125\322\255\161\205\175\352\036\204\334\156\147\156\221"
	"\055\147\303\110\142\354\014\352\301\004\013\106\232\121\173\211"
	"\161\212\352\014\170\234\325\004\216\340\311\342\153\230\361\076"
	"\013\301\241\056\073\061\141\156\337\165\060\023\203\353\327\046"
	"\201\267\332\161\034\153\335\006\175\300\264\077\260\141\106\120"
	"\173\060\100\121\201\077\065\040\373\057\273\213\313\030\373\070"
	"\033\300\042\335\353\346\263\173\351\030\163\021\340\150\073\100"
	"\062\245\362\077\116\326\107\177\303\301\126\263\367\213\015\067"
	"\202\170\046\376\313\164\014\011\143\007\117\321\021\346\143\071"
	"\353\352\035\256\314\267\340\031\202\331\035\237\336\335\341\034"
	"\352\022\041\154\062\030\370\342\340\313\106\164\046\166\150\344"
	"\227\025\033\062\211\134\165\251\172\160\235\270\263\356\343\136"
	"\050\162\245\132\025\212\070\367\041\270\320\217\341\375\205\121"
	"\356\052\036\005\013\315\123\306\061\062\223\107\335\206\173\077"
	"\360\223\315\037\063\145\060\260\341\213\230\072\070\201\334\176"
	"\152\112\255\315\263\141\157\303\307\063\341\207\101\001\214\062"
	"\070\020\104\243\053\330\103\014\264\252\155\312\206\030\175\366"
	"\042\136\246\256\053\000\247\140\247\265\321\070\026\173\210\277"
	"\256\136\033\261\260\107\350\146\116\160\203\137\151\113\313\262"
	"\001\150\306\300\105\341\133\271\104\343\006\212\344\236\311\025"
	"\374\363\076\323\166\040\032\245\145\077\134\043\220\323\242\237"
	"\316\111\012\301\270\001\332\321\264\016\206\157\347\064\274\173"
	"\273\303\022\075\346\044\255\204\325\237\337\246\116\343\122\166"
	"\067\130\243\106\330\336\062\325\356\065\056\321\326\362\111\217"
	"\225\307\377\224\040\370\224\355\365\327\120\202\166\256\061\332"
	"\275\255\116\240\047\302\207\261\174\110\027\316\350\354\037\205"
	"\066\171\067\206\215\131\035\023\135\070\167\357\325\107\355\250"
	"\364\305\236\342\051\214\204\012\147\021\051\133\116\374\366\000"
	"\217\115\011\016\073\106\105\263\366\206\010\333\247\350\312\222"
	"\017\224\234\007\341\166\323\173\027\166\024\063\260\067\224\321"
	"\317\072\023\140\127\113\355\151\211\133\163\210\151\120\255\211"
	"\310\061\074\163\361\307\140\322\343\267\234\234\046\161\241\054"
	"\156\330\124\057\016\360\335\116\225\244\340\320\001\076\246\046"
	"\071\132\215\046\142\357\260\363\135\031\207\054\145\026\355\260"
	"\171\040\305\023\352\350\325\346\320\175\054\142\111\030\301\367"
	"\143\175\362\251\272\077\302\277\154\244\070\321\222\233\364\316"
	"\172\243\077\210\172\133\004\123\262\262\175\045\071\016\114\026"
	"\336\036\102\122\125\103\353\262\205\337\176\315\237\366\161\261"
	"\171\074\103\224\035\025\127\041\034\207\371\371\160\207\236\245"
	"\272\010\147\113\327\231\250\242\261\235\154\331\256\055\001\332"
	"\351\164\112\104\010\362\107\363\150\233\124\013\140\164\043\037"
	"\020\047\137\332\077\355\326\113\077\310\154\326\206\274\244\044"
	"\124\102\131\243\323\142\111\152\211\151\021\062\031\076\323\147"
	"\027\060\145\223\041\351\244\137\356\324\263\254\357\101\156\274"
	"\377\306\106\135\305\150\030\355\053\210\265\054\171\317\362\334"
	"\043\127\366\041\106\363\070\054\217\006\230\220\021\022\206\063"
	"\020\072\117\264\265\243\161\366\102\053\037\221\203\117\112\137"
	"\363\230\342\322\174\001\027\300\372\323\107\157\376\134\010\330"
	"\047\336\007\177\376\265\023\031\232\254\177\247\017\277\123\244"
	"\275\125\057\210\250\124\041\105\112\271\300\365\205\204\366\040"
	"\050\005\306\273\103\112\246\113\240\217\020\161\216\323\370\271"
	"\244\126\216\311\326\205\117\073\377\114\336\315\245\317\241\226"
	"\341\314\107\225\163\354\253\020\312\354\000\307\375\244\357\016"
	"\112\356\004\320\225\134\350\333\173\265\320\027\123\164\057\364"
	"\101\336\045\344\360\065\266\325\323\233\302\224\254\072\002\267"
	"\062\251\046\067\124\005\201\101\226\050\116\164\252\076\362\030"
	"\201\127\164\251\046\206\364\107\007\132\334\303\041\241\257\265"
	"\244\237\300\221\143\044\344\201\201\064\036\314\105\026\357\151"
	"\034\342\361\144\210\265\203\143\225\264\315\047\051\003\173\377"
	"\016\230\120\246\153\157\032\245\344\034\117\331\355\076\222\320"
	"\136\036\154\153\371\266\331\226\216\201\255\025\072\052\213\323"
	"\252\245\073\276\174\044\303\005\222\245\232\140\337\051\130\201"
	"\115\361\233\053\003\027\255\354\334\173\202\243\057\150\333\014"
	"\111\351\233\237\067\123\010\071\312\042\306\265\115\274\077\330"
	"\335\062\276\037\202\336\031\253\260\366\026\024\160\102\373\317"
	"\335\151\177\316\033\356\071\334\011\170\237\016\211\216\075\012"
	"\063\263\155\174\225\044\012\030\110\053\313\247\330\243\010\132"
	"\167\066\255\267\172\325\316\247\002\066\075\355\135\232\376\112"
	"\110\151\262\304\254\020\167\050\063\374\213\373\255\075\364\374"
	"\165\010\325\213\355\271\273\074\050\175\067\273\315\366\337\254"
	"\002\061\266\142\300\305\202\206\034\201\270\153\227\350\343\134"
	"\314\130\324\275\325\214\222\051\242\247\243\050\151\064\105\016"
	"\044\343\150\245\025\377\362\060\072\034\150\147\173\261\175\261"
	"\142\375\063\113\050\175\366\220\306\350\106\373\147\025\364\275"
	"\304\123\015\033\200\002\054\167\101\377\107\132\332\045\166\006"
	"\330\105\345\374\376\366\375\117\067\342\053\232\110\055\237\237"
	"\212\213\227\224\345\116\254\341\244\220\005\230\274\161\221\174"
	"\321\260\003\326\121\040\310\046\101\030\240\256\334\105\045\367"
	"\362\260\325\247\114\253\162\302\042\331\060\065\274\117\122\246"
	"\370\021\035\337\133\255\132\346\312\057\140\330\051\336\047\342"
	"\265\113\340\326\151\321\121\117\100\047\204\117\127\372\132\223"
	"\236\325\016\121\143\235\045\172\167\043\326\121\351\136\042\337"
	"\111\015\275\127\240\120\004\115\235\172\040\274\023\235\223\175"
	"\361\177\163\035\271\257\327\017\240\323\220\160\246\111\327\156"
	"\215\136\026\345\337\205\363\274\230\226\162\257\221\120\301\224"
	"\037\040\361\167\114\202\117\112\254\105\200\143\231\374\303\100"
	"\155\226\261\163\211\214\151\300\022\264\241\061\000\000\003\157"
	"\213\173\001\207\104\015\126\162\255\260\222\360\264\017\215\373"
	"\231\272\110\044\371\006\311\320\352\006\305\337\100\047\212\063"
	"\227\003\344\220\175\145\115\154\107\252\167\111\320\355\376\231"
	"\356\060\072\115\046\364\146\156\007\074\155\300\065\136\234\021"
	"\020\013\254\337\222\241\057\330\001\027\165\015\242\367\360\001"
	"\234\301\014\225\351\100\004\132\236\372\007\323\152\021\240\335"
	"\052\366\121\254\357\046\150\236\210\274\000\177\134\046\144\365"
	"\165\171\212\137\272\216\271\131\211\300\054\363\322\315\321\374"
	"\303\042\250\262\111\021\121\321\315\122\120\052\171\264\037\356"
	"\056\252\116\350\071\007\102\302\310\156\266\233\073\207\227\377"
	"\252\100\262\363\121\003\305\037\125\026\111\316\312\151\275\371"
	"\024\014\342\115\023\044\017\334\222\306\167\316\115\017\316\370"
	"\117\200\354\241\203\261\300\331\307\012\250\222\163\146\213\210"
	"\162\155\325\206\221\345\143\044\253\333\362\371\352\301\361\071"
	"\101\335\332\305\216\233\237\126\245\107\350"
#define      msg1_z	42
#define      msg1	((&data[3878]))
	"\241\041\341\167\250\162\134\320\376\307\365\134\305\367\220\064"
	"\277\151\300\160\073\010\354\374\060\140\360\217\115\212\335\261"
	"\130\037\114\153\234\146\034\277\255\073\120\116\075\303\100\020"
	"\052\013\226\010\346"
#define      chk1_z	22
#define      chk1	((&data[3924]))
	"\246\232\364\334\300\240\272\213\074\232\323\146\122\276\213\345"
	"\047\354\323\015\000\152\112\362\012\214"
#define      tst2_z	19
#define      tst2	((&data[3954]))
	"\136\201\360\265\237\014\273\024\245\061\104\331\212\254\271\307"
	"\131\060\151\141\367\324\047\047"
#define      shll_z	10
#define      shll	((&data[3975]))
	"\346\012\151\325\026\114\020\165\155\374\166"
#define      date_z	1
#define      date	((&data[3985]))
	"\057"
#define      pswd_z	256
#define      pswd	((&data[4008]))
	"\145\266\273\373\276\242\205\277\163\320\261\176\134\201\144\255"
	"\340\346\236\226\015\326\100\372\170\044\341\346\125\247\174\111"
	"\276\351\370\356\231\027\027\030\010\316\216\161\362\001\255\263"
	"\201\173\071\127\011\172\121\202\237\063\151\364\332\345\075\230"
	"\316\065\206\147\115\236\200\125\155\017\307\137\021\164\023\222"
	"\360\115\351\371\307\072\174\146\156\345\132\111\313\230\341\231"
	"\316\150\001\033\007\202\161\165\221\070\325\242\254\350\064\234"
	"\065\036\226\374\131\023\143\307\371\275\020\304\126\362\136\044"
	"\133\140\077\142\342\260\330\163\351\255\026\225\225\112\062\313"
	"\150\311\307\301\335\053\211\326\350\231\233\077\214\371\143\347"
	"\132\243\112\074\123\042\260\075\317\306\323\145\021\005\060\171"
	"\317\370\073\254\043\305\203\014\137\036\113\353\030\257\323\162"
	"\122\036\257\246\100\137\343\020\045\266\166\066\274\247\260\213"
	"\237\354\070\302\261\273\317\020\331\033\374\362\312\317\144\034"
	"\355\023\302\056\163\246\077\230\134\265\317\031\134\177\244\374"
	"\154\335\277\035\230\216\056\162\251\052\144\164\371\311\220\347"
	"\335\123\025\120\371\124\351\126\012\270\157\147\070\024\143\244"
	"\361\042\301\212\261\357\063\115\275\105\060\305\070\211\166\235"
	"\077\061\230\375\324\036\274\110\356\156\306\112\360\053\370\321"
	"\021\226\147\036\154\233\154\051\340\234\357\030\045\145\265\145"
	"\227\116"
#define      xecc_z	15
#define      xecc	((&data[4309]))
	"\037\116\366\273\153\336\041\046\075\315\216\363\334\237\341\243"
	"\264"
#define      lsto_z	1
#define      lsto	((&data[4325]))
	"\375"
#define      msg2_z	19
#define      msg2	((&data[4328]))
	"\235\120\123\130\371\100\100\243\054\161\026\233\211\300\344\252"
	"\144\065\001\056\034\270\063\270"
#define      inlo_z	3
#define      inlo	((&data[4350]))
	"\341\065\351"
#define      tst1_z	22
#define      tst1	((&data[4357]))
	"\337\271\115\005\333\134\377\024\337\210\231\000\017\306\067\263"
	"\055\225\073\204\125\327\355\153\152\314\037"
#define      rlax_z	1
#define      rlax	((&data[4380]))
	"\362"
#define      opts_z	1
#define      opts	((&data[4381]))
	"\014"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
