#if 0
	shc Version 3.8.7, Generic Script Compiler
	Copyright (c) 1994-2009 Francisco Rosales <frosal@fi.upm.es>

	./shc -v -r -T -f podscript.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\176"
#define      xecc_z	15
#define      xecc	((&data[1]))
	"\201\052\245\035\172\236\047\332\333\263\160\334\242\033\150"
#define      pswd_z	256
#define      pswd	((&data[70]))
	"\132\154\242\005\200\163\076\163\322\261\011\263\212\376\331\264"
	"\341\226\216\276\307\035\341\125\121\101\140\153\110\067\222\243"
	"\243\065\251\044\251\347\227\173\230\241\057\043\240\010\327\201"
	"\237\146\100\147\204\041\064\261\343\204\127\024\121\253\343\177"
	"\303\163\261\337\256\174\241\045\127\151\244\143\157\076\121\001"
	"\066\160\145\027\377\231\310\342\036\040\367\157\313\332\357\217"
	"\116\240\157\375\035\020\043\165\172\307\331\352\005\052\354\073"
	"\232\122\123\232\354\034\174\012\074\164\172\010\117\151\227\235"
	"\012\007\233\047\030\277\234\222\207\166\175\214\241\151\310\073"
	"\274\034\326\250\070\122\262\164\307\055\175\026\226\025\264\240"
	"\034\117\310\064\017\145\307\226\333\104\043\174\256\353\270\152"
	"\007\216\022\077\341\305\264\250\362\061\276\211\106\162\051\143"
	"\302\361\227\321\126\136\147\061\242\213\255\120\167\145\272\176"
	"\364\315\276\325\223\163\175\205\245\074\016\354\256\070\117\161"
	"\051\347\102\200\105\252\262\350\065\137\070\255\305\363\053\272"
	"\301\352\217\124\136\015\332\004\111\351\360\370\041\100\151\113"
	"\047\254\314\155\127\176\125\215\336\216\072\243\202\146\136\103"
	"\121\355\230\257\373\163\264\104\134\245\075\176\346\247\312\015"
	"\123\226\173\253\024\320\070\362\137\162\226\341\331\364\045\052"
	"\342\275\332\335\060\216\274\325\143\035\100\253\124\323\117\367"
#define      msg1_z	42
#define      msg1	((&data[346]))
	"\263\340\263\057\171\125\136\234\365\147\121\120\036\275\107\121"
	"\023\256\222\003\012\172\101\020\302\166\337\351\064\311\174\314"
	"\015\355\204\367\331\155\072\061\163\302\120\041\217\133\065\003"
	"\163\315\262\042\164"
#define      lsto_z	1
#define      lsto	((&data[389]))
	"\150"
#define      rlax_z	1
#define      rlax	((&data[390]))
	"\243"
#define      text_z	1947
#define      text	((&data[473]))
	"\073\110\165\347\234\111\066\224\123\057\260\006\020\144\065\212"
	"\271\224\046\257\374\233\046\003\166\335\162\325\265\236\012\361"
	"\346\200\330\203\312\017\030\035\077\310\044\117\054\131\331\346"
	"\356\000\225\352\233\273\356\021\230\141\347\116\377\362\077\346"
	"\163\030\152\075\047\202\133\147\113\200\267\170\331\220\136\310"
	"\221\364\200\066\136\077\245\131\142\263\037\150\173\332\135\332"
	"\267\036\056\004\221\214\124\155\074\031\307\155\277\120\112\313"
	"\375\066\015\122\331\234\127\200\217\376\275\147\123\321\152\330"
	"\034\367\231\067\233\141\234\355\373\002\205\022\131\235\260\147"
	"\116\106\240\024\112\317\327\152\345\033\357\013\273\310\341\054"
	"\373\342\216\235\071\012\374\315\145\032\336\255\151\246\204\256"
	"\261\232\200\215\227\021\066\014\355\334\211\336\323\125\242\354"
	"\167\337\274\150\000\146\337\116\166\123\330\027\041\354\307\165"
	"\006\343\260\052\263\356\250\327\366\161\134\045\057\365\223\070"
	"\240\307\231\002\223\322\333\137\077\103\113\307\350\243\060\176"
	"\241\120\064\326\252\070\137\314\330\226\271\132\217\052\111\107"
	"\251\107\252\064\163\127\227\102\171\206\002\064\273\265\054\271"
	"\254\317\255\167\240\325\225\306\275\110\372\365\006\211\024\155"
	"\155\326\274\247\070\131\213\066\022\236\252\314\375\262\254\164"
	"\252\207\335\354\326\000\334\014\052\101\214\134\255\374\153\331"
	"\353\144\044\063\213\265\046\054\335\167\302\277\261\346\072\060"
	"\270\235\002\360\251\277\355\015\054\366\261\300\223\325\375\272"
	"\376\316\167\307\056\217\326\346\021\146\353\106\171\142\010\362"
	"\100\071\071\142\114\244\153\377\056\102\014\373\325\111\103\133"
	"\256\126\177\152\010\212\044\173\044\363\326\156\043\210\335\024"
	"\311\255\215\163\323\034\076\165\370\057\323\055\344\007\363\223"
	"\047\345\360\131\015\357\053\225\050\010\353\031\375\232\061\206"
	"\014\071\212\175\274\140\033\101\371\146\375\231\165\152\101\251"
	"\260\120\260\202\327\214\034\067\105\345\077\014\002\116\375\334"
	"\112\270\135\264\120\362\105\036\042\143\211\217\370\223\202\076"
	"\136\053\166\150\174\235\253\233\103\160\223\366\072\172\271\250"
	"\120\373\302\214\105\222\247\050\262\364\375\114\153\055\116\154"
	"\350\240\234\036\252\110\360\124\341\302\004\056\343\212\327\171"
	"\202\250\256\276\012\245\265\212\300\303\157\164\111\013\226\245"
	"\013\251\200\134\341\162\120\165\350\001\325\121\301\266\140\020"
	"\021\333\167\175\152\077\336\056\034\011\162\227\361\015\357\132"
	"\242\376\253\117\352\251\300\012\174\233\301\131\147\245\224\037"
	"\011\302\227\066\156\162\053\114\331\276\076\365\236\367\204\230"
	"\354\252\316\116\304\010\216\107\217\305\351\344\220\070\151\303"
	"\055\370\101\323\300\356\000\132\064\165\316\066\240\256\023\206"
	"\202\325\017\230\061\262\166\207\270\022\114\270\300\321\323\347"
	"\237\176\343\362\377\160\133\262\032\002\212\221\011\276\064\124"
	"\251\117\351\274\104\017\307\353\164\263\264\036\007\042\273\103"
	"\322\372\005\220\163\206\175\257\063\072\006\224\357\177\144\301"
	"\342\035\027\302\141\342\050\372\363\133\144\066\042\154\162\244"
	"\122\033\176\037\101\110\265\074\236\221\336\260\160\301\076\143"
	"\236\114\034\173\364\070\007\272\017\362\352\253\175\324\351\175"
	"\324\221\255\061\320\211\260\301\054\267\014\357\173\140\076\101"
	"\101\373\056\311\374\304\272\335\050\254\244\064\001\175\363\053"
	"\005\256\320\044\214\155\220\060\037\303\050\177\365\027\337\352"
	"\154\317\167\252\224\327\107\166\244\340\052\306\242\266\175\226"
	"\125\271\172\310\002\112\066\352\275\377\167\231\126\173\136\140"
	"\365\035\114\021\133\313\326\201\114\247\272\034\354\121\362\223"
	"\100\155\377\151\256\304\324\107\015\200\042\014\312\165\221\340"
	"\022\052\034\246\055\002\341\311\327\354\175\146\336\303\023\026"
	"\371\256\052\102\000\243\160\201\026\140\275\154\357\020\025\232"
	"\161\224\240\066\261\235\032\107\307\002\004\364\124\047\071\012"
	"\003\201\123\314\311\377\067\131\240\030\327\157\143\242\374\340"
	"\076\224\265\207\147\274\315\113\066\155\263\215\064\346\021\072"
	"\230\051\027\001\277\150\005\314\357\236\171\333\132\133\153\366"
	"\226\172\061\024\170\225\335\176\053\014\327\111\101\240\304\000"
	"\137\270\216\124\076\066\052\120\045\026\372\343\141\130\075\371"
	"\327\111\254\326\017\053\300\345\176\045\162\336\070\034\157\201"
	"\240\354\146\026\244\235\055\370\321\247\036\025\160\235\145\320"
	"\250\013\301\246\000\224\173\271\062\106\055\322\312\061\051\075"
	"\201\041\011\337\170\036\024\275\136\344\067\157\103\214\152\333"
	"\125\051\025\337\025\221\131\145\217\170\316\054\014\071\071\205"
	"\216\053\356\053\261\062\171\035\103\126\252\334\151\100\153\162"
	"\050\075\032\266\332\317\264\113\350\262\120\144\321\032\231\105"
	"\316\016\335\216\117\377\144\040\312\075\221\313\375\304\370\065"
	"\145\311\224\320\264\004\116\300\213\302\276\271\146\012\010\370"
	"\236\146\131\044\163\133\030\103\010\161\212\023\034\365\202\202"
	"\367\232\144\006\355\277\046\360\171\056\123\021\033\071\047\211"
	"\040\357\131\347\047\054\057\046\203\073\322\220\217\053\160\105"
	"\255\257\164\012\373\063\017\363\033\073\143\165\262\371\237\207"
	"\334\326\301\144\174\237\120\371\101\277\030\040\251\060\357\235"
	"\273\257\173\335\104\251\350\111\127\106\346\043\153\332\275\364"
	"\026\113\174\330\141\236\134\132\161\110\243\336\022\366\300\074"
	"\354\206\237\223\272\051\032\240\307\252\140\127\172\105\273\235"
	"\237\330\300\344\373\224\152\257\332\323\337\024\275\005\217\011"
	"\340\352\214\341\371\060\077\027\214\064\020\000\276\216\357\107"
	"\105\357\242\210\343\266\040\152\371\165\045\277\127\203\143\031"
	"\056\125\377\311\112\101\075\012\230\245\024\353\176\011\143\073"
	"\057\167\046\225\137\336\066\206\032\104\363\161\024\350\161\326"
	"\104\023\264\352\121\242\266\033\143\246\032\057\272\051\167\364"
	"\373\076\232\066\321\042\111\266\031\371\371\000\051\107\073\044"
	"\034\217\004\236\156\150\101\357\111\265\133\221\375\103\006\030"
	"\215\221\300\051\014\141\324\037\270\063\016\172\142\074\272\302"
	"\014\352\155\045\166\211\145\355\106\204\152\144\036\065\223\254"
	"\106\241\216\172\147\311\245\102\114\341\035\264\146\155\103\060"
	"\053\360\015\366\317\144\163\067\245\337\074\101\376\251\224\170"
	"\214\132\206\305\377\024\005\265\212\332\257\167\156\002\304\067"
	"\013\244\331\254\244\155\201\143\066\065\245\313\274\361\052\175"
	"\075\012\222\110\221\071\212\054\332\324\004\375\206\361\237\324"
	"\241\266\234\315\271\037\226\157\222\034\235\250\257\173\342\044"
	"\044\010\302\211\320\265\245\271\160\173\040\222\027\233\056\151"
	"\236\256\234\153\107\302\223\002\320\203\142\040\064\034\131\112"
	"\360\306\054\371\130\302\046\035\207\063\124\144\020\167\172\001"
	"\230\245\015\377\024\157\342\323\151\212\241\163\216\306\153\214"
	"\010\347\301\200\313\201\224\003\022\017\266\037\273\306\214\166"
	"\246\133\163\161\322\314\360\067\041\252\042\114\353\352\310\117"
	"\074\350\122\142\160\246\050\011\230\313\133\242\001\141\364\206"
	"\176\077\370\236\372\153\041\351\325\135\344\253\275\265\156\040"
	"\035\215\031\131\157\150\261\062\022\073\303\242\124\116\313\045"
	"\317\112\173\016\221\146\127\253\162\253\214\213\260\155\221\177"
	"\261\372\334\223\163\375\241\262\265\352\064\017\076\175\234\217"
	"\324\234\066\003\326\342\112\024\307\034\370\017\222\176\342\150"
	"\366\236\164\116\240\275\242\347\155\147\220\375\264\363\231\027"
	"\273\236\207\312\335\100\071\302\222\310\327\202\160\347\267\066"
	"\310\364\276\274\051\242\245\160\043\233\206\357\210\137\267\003"
	"\100\332\172\017\162\365\255\371\315\175\360\222\204\162\170\121"
	"\353\010\113\076\135\352\217\105\134\103\235\344\244\043\157\032"
	"\152\342\113\153\217\362\273\170\356\074\271\166\304\050\111\203"
	"\336\300\346\276\025\276\122\335\361\354\205\367\046\233\340\371"
	"\012\110\043\174\070\006\141\243\176\016\214\271\307\377\353\073"
	"\375\112\031\343\062\036\077\340\326\201\073\254\067\041\271\045"
	"\044\137\037\067\220\373\027\344\074\031\066\360\042\227\312\316"
	"\055\171\357\334\122\050\313\065\364\344\374\054\311\157\204\130"
	"\117\301\260\322\354\347\374\077\347\362\054\240\237\355\162\251"
	"\124\063\273\245\257\060\360\263\141\255\043\117\266\120\024\245"
	"\030\074\025\101\116\331\334\074\076\063\341\237\164\010\114\332"
	"\042\240\177\055\054\144\206\166\006\366\265\343\157\341\033\173"
	"\270\172\210\352\367\200\005\317\017\200\053\323\134\234\246\154"
	"\176\374\017\250\270\057\160\057\375\133\262\046\067\071\347\052"
	"\236\255\115\370\056\103\126\054\224\024\045\270\330\117\177\103"
	"\132\122\100\051\260\345\333\126\326\027\114\105\117\233\274\142"
	"\020\106\030\231\123\307\067\223\271\145\025\063\244\262\055\257"
	"\241\077\110\003\046\226\002\030\326\351\214\356\123\311\026\326"
	"\045\175\041\245\064\231\177\305\370\107\126\354\372\204\234\234"
	"\303\344\237\351\172\241\002\120\213\216\077\336\130\125\264\175"
	"\322\326\042\007\157\241\315\147\351\044\124\343\250\360\177\153"
	"\324\036\124\117\300\127\240\113\345\337\052\076\065\336\273\010"
	"\264\335\017\044\177\334\214\150\000\340\114\250\321\314\023\246"
	"\352"
#define      tst1_z	22
#define      tst1	((&data[2525]))
	"\277\226\367\245\166\212\107\351\143\126\041\166\017\214\201\217"
	"\054\206\227\330\222\066\155\201\332\160\150\041\343\253\000"
#define      msg2_z	19
#define      msg2	((&data[2554]))
	"\175\303\331\303\267\275\170\243\331\214\334\076\122\166\223\141"
	"\017\145\267\255\261\235\374\237\146"
#define      chk1_z	22
#define      chk1	((&data[2579]))
	"\262\111\030\310\002\114\153\101\007\246\307\000\157\367\216\063"
	"\307\056\303\333\030\150\137\241\270\176"
#define      opts_z	1
#define      opts	((&data[2602]))
	"\115"
#define      tst2_z	19
#define      tst2	((&data[2606]))
	"\205\113\014\042\120\351\046\372\375\020\361\273\373\232\323\257"
	"\075\350\326\103\321\373"
#define      shll_z	10
#define      shll	((&data[2627]))
	"\017\155\247\120\152\331\127\300\265\322\356\041"
#define      inlo_z	3
#define      inlo	((&data[2637]))
	"\174\065\203"
#define      chk2_z	19
#define      chk2	((&data[2640]))
	"\052\215\306\002\341\225\370\220\251\275\072\106\042\213\035\166"
	"\144\162\332\274\050\203\043"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
